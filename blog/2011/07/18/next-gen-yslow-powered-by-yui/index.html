<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta name="viewport" content="width=960" id="meta-viewport">
    <script>
    if (screen.width < 768) {
        document.getElementById('meta-viewport').setAttribute('content', 'width=768');
    }
    </script>



	<title>Next-Gen YSlow powered by YUI</title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

	<!-- IMPORT: yuilibrary.com -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic">
	<link rel="stylesheet" type="text/css" href="/vendor/yui/cssgrids-min.css">
	<link rel="stylesheet" type="text/css" href="/combo/main-min.css">
	<link rel="stylesheet" type="text/css" href="/vendor/prettify/prettify-min.css">
	<link rel="stylesheet" type="text/css" href="/css/docs-min.css">

	<link rel="stylesheet" href="/css/blog.css" type="text/css" />


    <!-- GOOGLE ANALYTICS SCRIPT.
        When changing themes, be sure to copy/paste this script from this theme to the new theme.
    -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-34018865-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

</head>

<body class="single single-post postid-5469 single-format-standard yui3-skin-sam">

	<div id="doc">
	      <div id="hd" class="yui3-g">
		</div>
		<div id="bd" class="clearfix yui3-g">

		<div class="yui3-u-3-4" class="post-5469 post type-post status-publish format-standard hentry category-development category-performance" id="post-5469">

			<div class="content">


				<ul class="breadcrumbs">
                    <li class="front_page"><a href="//yuilibrary.com/">YUI</a></li>
                    <li><a href="/">Blog</a></li>
                    <li><a href="/blog/category/development/">Development</a></li>
                    <li class="current">Next-Gen YSlow powered by YUI</li></ul>
				<h1 class="yui3-u-7-8">Next-Gen YSlow powered by YUI</h1>

				<div class="entry yui3-u-1">
					<div class="meta">
    <img src="https://www.gravatar.com/avatar/d011327f5a3d4f1dc4215968e2bfd524?s=32"> <div class="cont"><a href="http://developer.yahoo.com/yui/" class="name">By YUI Team</a><span class="date">July 19, 2011<span></div></div>

<div class="blog" id="blog-content">
	<p>A couple of weeks ago, Yahoo! announced <a href="http://developer.yahoo.com/blogs/ydn/posts/2011/06/yslowmobile/">YSlow for Mobile</a> at <a href="http://velocityconf.com/velocity2011/public/schedule/detail/20287">Velocity 2011</a>, bringing the power of YSlow performance analysis to the mobile world.<p><a href="http://developer.yahoo.com/yslow/mobile/">YSlow for Mobile</a> works as a <a href="http://en.wikipedia.org/wiki/Bookmarklet">bookmarklet</a>, making it possible to run on browsers other than <a href="https://addons.mozilla.org/en-US/firefox/addon/5369">Firefox (as an add-on)</a> or <a href="https://chrome.google.com/webstore/detail/ninejjcohidippngpapiilnmkgllmakh">Chrome (as an extension)</a>.<p>The YSlow architecture was partially redesigned to work cross-platform and YUI was the essential factor in make sandboxing, cross-browser abstraction and simple YQL access possible.<h3>Sandboxing</h3>
	<p>In order to be embedded on a page without interfering with performance analysis and without messing with the page itself, YSlow is a bookmarklet that injects JavaScript and CSS into any page by leveraging the power of YUI sandboxing:<p>Bookmarklet URL:<pre>
javascript:(function (y, p, o) {
    p = y.body.appendChild(y.createElement('iframe'));
    p.id = 'YSLOW-bookmarklet';
    p.style.cssText = 'display:none';
    o = p.contentWindow.document;
    o.open().write('
        &lt;head&gt;
        &lt;body onload = "
            YUI_config = {
                win: window.parent,
                doc: window.parent.document
            };
            var d = document;
            d.getElementsByTagName(\'head\')[0]
                .appendChild(
                    d.createElement(\'script\')
                ).src = \'http://d.yimg.com/jc/yslow-bookmarklet.js\'"
        &gt;
    ');
    o.close()
}(document))
</pre><p>The code above:<ul>
			<li>creates an empty iframe;<li>appends it to the page body;<li>hides the iframe*;<li>gets its window handler;<li>writes into its content the body of the iframe;<li>this body is empty but has an <code>onload</code> event<li>the <code>onload</code> event defines how to inject YSlow JS: <ul>
					<li>sets <code>YUI_config</code>, so <code>win</code> and <code>doc</code> points to the page being analyzed <code>window</code> and <code>document</code> respectively<li>dynamically injects YSlow URL by creating a <code>script</code> element into iframe's <code>head</code></ul> </ul> <p><i>* the iframe is displayed by the time all YSlow presentation assets are loaded</i><p>This will place an iframe into the page being analyzed. This iframe will act as a sandboxed environment and YSlow will reside within it. Since the iframe is dynamically created without the <code>src</code> attribute, it will have access to its parent (the page being analyzed) because there's no <a href="https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript">same origin policy</a> violation happening there.<p>The <a href="http://developer.yahoo.com/yui/3/api/config.html">YUI_config</a> object is handy because it sets <code>win</code> and <code>doc</code> to the iframe's parent (the page being analyzed), thus any new YUI instance will be bound to the parent document by default, wiring any call to <code>Y.all</code> and <code>Y.one</code> through <code>Y.config.win</code> or <code>Y.config.doc</code> from the YUI <a href="http://developer.yahoo.com/yui/3/yui/#use"><code>use</code></a> callback.<p>YSlow's presentation is handled by the iframe <code>window</code> and <code>document</code> references, allowing the YSlow main script to render the markup as well as fetch the external CSS within this iframe without conflicting with the parent page's styles. YSlow scans the parent page in order to get all the components (images, scripts, links, background-images, flash, etc.) required for later performance analysis. This is done by accessing <code>Y.config.win</code> and <code>Y.config.doc</code>, since they refer to the parent page.<h3>Cross-browser abstraction</h3>
	<p>Being a bookmarklet, YSlow for Mobile is supposed to work on any browser*. YUI abstracts cross-browser issues by normalizing browser differences, resulting in a clean, easy-to-read and maintainable codebase.<p>YSlow was not fully ported to YUI 3 &mdash; only the controller layer (from the upcoming App component) for now &mdash; but still, all DOM manipulation and event handling are done by the <a href="http://developer.yahoo.com/yui/3/node/"><code>node</code></a> and <a href="http://developer.yahoo.com/yui/3/event/"><code>event</code></a> modules. In future releases we plan to port more YSlow features to YUI 3.<p><i>* not all browsers are currently supported</i><h3>YQL</h3>
	<p>YSlow analyzes pages by checking the HTTP headers for the components found on the page. HTTP response headers are not available in the page, hence those components need to be requested again in order for YSlow get the response header information. This could be achieved by requesting the list of component URLs through XmlHttpRequest (AJAX) but unfortunately due to <a href="http://en.wikipedia.org/wiki/Same_origin_policy">same origin policy restriction</a>, this is not possible unless all components are in the same domain as the page which is very unlikely.<p>A common workaround for same origin policy restriction is using JSONP, where an external server works as a proxy requesting the list of components URLs and retrieving their HTTP response headers on behalf of YSlow. Due to YSlow's popularity and recent mobile performance analysis efforts, we're expecting quite heavy traffic for the YSlow for Mobile bookmarklet. In order to support such traffic, <a href="http://developer.yahoo.com/yql/">YQL</a> was the scalable solution adopted by YSlow through an <a href="http://www.datatables.org/">open data table</a> named <a href="http://developer.yahoo.com/yql/console/?q=select%20*%20from%20data.headers%20where%20url%3D%22http%3A//getyslow.com/%22&env=http%3A%2F%2Fdatatables.org%2Falltables.env">data.headers</a>, which retrieves the response headers and content for a given list of URLs while impersonating the user-agent to ensure the expected content is retrieved.<p>The <a href="http://developer.yahoo.com/yui/3/yql/">YQL Query</a> component does all the work of managing YQL queries while managing JSONP requests under the hood, making the YSlow controller code much simpler and easy-to-maintain.<h3>Future enhancements: New YSlow for Mobile friendly interface</h3>
	<p>Currently the YSlow for Mobile user experience is the same as the desktop experience. Dealing with a long list of performance analysis data is not the best experience on small smart-phone screens. Since YUI also abstracts <a href="http://developer.yahoo.com/yui/3/event/#gestures">cross-device gestures</a>, YSlow for Mobile will get a brand new mobile-friendly interface in future releases.<h3>Performance of performance tool</h3>
	<p>YSlow for Mobile deployment was made carefully considering its performance impact on the load time of the page being analyzed. The YUI 3 modules used on YSlow were scrutinized to include only the modules needed to load YSlow as fast as possible. The YUI seed file and Loader <a href="http://developer.yahoo.com/yui/3/configurator/">were not included</a> since all necessary modules and submodules were combined together following <a href="http://developer.yahoo.com/yui/theater/video.php?v=grove-zen">Ryan Grove's Performance Zen</a> tips, which made it possible to load everything together into a single small single request: yslow-bookmarklet.js: 204KB, 66KB (gzip) where:<ul>
			<li>YUI: 75KB, 27KB (gzip)<li>YSlow: 129KB, 39KB (gzip)</ul> <h3>More about YSlow</h3>
	<p>Keep up-to-date with the latest YSlow announcements by:<ul>
			<li>Visiting the redesigned YSlow page at <a href="http://getyslow.com/">getyslow.com</a><li>Liking YSlow on Facebook: <a href="http://www.facebook.com/getyslow/">facebook.com/getyslow</a><li>Following YSlow on Twitter: <a href="http://twitter.com/getyslow/">twitter.com/getyslow</a></ul> <p class="authorbox"><img alt="Marcel Duran" class="alignleft" height="160" src="/blog-archive/assets/next-gen-yslow/marcel.jpg" width="120" /><em><strong>About the author:</strong> Marcel Duran is the Front End Lead for Yahoo!'s Exceptional Performance Team. He has been into web performance optimization on high traffic sites in Yahoo! Front Page and Search teams where he applied and researched web performance best practices making pages even faster. He is now dedicated to YSlow and other performance tools development, researches and evangelism. His goal is to make the web even faster than it can be and believes there is no such thing as "just a few milliseconds won't hurt".</em></div>



	<div class="navigation">
		<div class="next-posts"></div>
		<div class="prev-posts"></div>
	</div>


			</div>
		</div>
    </div>




<div id="sidebar" class="yui3-u-1-4"><div class="liner">

        <div id="recent-posts-3" class="sidebox widget widget_recent_entries">		<div class="hd"><h2>Recent Posts</h2></div><div class="bd">		<ul>
					<li>
				<a href="/blog/2014/08/25/weve-moved-to-tumblr/">Weâ€™ve Moved to Tumblr!</a>
						</li>
					<li>
				<a href="/blog/2014/06/16/yui-gallery-deprecation-announcement/">YUI Gallery Deprecation Announcement</a>
						</li>
					<li>
				<a href="/blog/2014/06/03/yui-3-17-2-released/">YUI 3.17.2 Released</a>
						</li>
					<li>
				<a href="/blog/2014/05/23/yui-3-17-2-release-candidate-1/">YUI 3.17.2 Release Candidate 1</a>
						</li>
					<li>
				<a href="/blog/2014/05/21/yui-3-17-1-released/">YUI 3.17.1 Released</a>
						</li>
				</ul>
		</div></div><div id="archives-3" class="sidebox widget widget_archive"><div class="hd"><h2>Archives</h2></div><div class="bd">		<select name="archive-dropdown" onchange='document.location.href=this.options[this.selectedIndex].value;'>
			<option value="">Select Month</option>

				<option value='/blog/2014/08/'> August 2014 </option>
	<option value='/blog/2014/06/'> June 2014 </option>
	<option value='/blog/2014/05/'> May 2014 </option>
	<option value='/blog/2014/04/'> April 2014 </option>
	<option value='/blog/2014/03/'> March 2014 </option>
	<option value='/blog/2014/02/'> February 2014 </option>
	<option value='/blog/2014/01/'> January 2014 </option>
	<option value='/blog/2013/12/'> December 2013 </option>
	<option value='/blog/2013/11/'> November 2013 </option>
	<option value='/blog/2013/10/'> October 2013 </option>
	<option value='/blog/2013/09/'> September 2013 </option>
	<option value='/blog/2013/08/'> August 2013 </option>
	<option value='/blog/2013/07/'> July 2013 </option>
	<option value='/blog/2013/06/'> June 2013 </option>
	<option value='/blog/2013/05/'> May 2013 </option>
	<option value='/blog/2013/04/'> April 2013 </option>
	<option value='/blog/2013/03/'> March 2013 </option>
	<option value='/blog/2013/02/'> February 2013 </option>
	<option value='/blog/2013/01/'> January 2013 </option>
	<option value='/blog/2012/12/'> December 2012 </option>
	<option value='/blog/2012/11/'> November 2012 </option>
	<option value='/blog/2012/10/'> October 2012 </option>
	<option value='/blog/2012/09/'> September 2012 </option>
	<option value='/blog/2012/08/'> August 2012 </option>
	<option value='/blog/2012/07/'> July 2012 </option>
	<option value='/blog/2012/06/'> June 2012 </option>
	<option value='/blog/2012/05/'> May 2012 </option>
	<option value='/blog/2012/04/'> April 2012 </option>
	<option value='/blog/2012/03/'> March 2012 </option>
	<option value='/blog/2012/02/'> February 2012 </option>
	<option value='/blog/2012/01/'> January 2012 </option>
	<option value='/blog/2011/12/'> December 2011 </option>
	<option value='/blog/2011/11/'> November 2011 </option>
	<option value='/blog/2011/10/'> October 2011 </option>
	<option value='/blog/2011/09/'> September 2011 </option>
	<option value='/blog/2011/08/'> August 2011 </option>
	<option value='/blog/2011/07/'> July 2011 </option>
	<option value='/blog/2011/06/'> June 2011 </option>
	<option value='/blog/2011/05/'> May 2011 </option>
	<option value='/blog/2011/04/'> April 2011 </option>
	<option value='/blog/2011/03/'> March 2011 </option>
	<option value='/blog/2011/02/'> February 2011 </option>
	<option value='/blog/2011/01/'> January 2011 </option>
	<option value='/blog/2010/12/'> December 2010 </option>
	<option value='/blog/2010/11/'> November 2010 </option>
	<option value='/blog/2010/10/'> October 2010 </option>
	<option value='/blog/2010/09/'> September 2010 </option>
	<option value='/blog/2010/08/'> August 2010 </option>
	<option value='/blog/2010/07/'> July 2010 </option>
	<option value='/blog/2010/06/'> June 2010 </option>
	<option value='/blog/2010/05/'> May 2010 </option>
	<option value='/blog/2010/04/'> April 2010 </option>
	<option value='/blog/2010/03/'> March 2010 </option>
	<option value='/blog/2010/02/'> February 2010 </option>
	<option value='/blog/2010/01/'> January 2010 </option>
	<option value='/blog/2009/12/'> December 2009 </option>
	<option value='/blog/2009/11/'> November 2009 </option>
	<option value='/blog/2009/10/'> October 2009 </option>
	<option value='/blog/2009/09/'> September 2009 </option>
	<option value='/blog/2009/08/'> August 2009 </option>
	<option value='/blog/2009/07/'> July 2009 </option>
	<option value='/blog/2009/06/'> June 2009 </option>
	<option value='/blog/2009/05/'> May 2009 </option>
	<option value='/blog/2009/04/'> April 2009 </option>
	<option value='/blog/2009/03/'> March 2009 </option>
	<option value='/blog/2009/02/'> February 2009 </option>
	<option value='/blog/2009/01/'> January 2009 </option>
	<option value='/blog/2008/12/'> December 2008 </option>
	<option value='/blog/2008/11/'> November 2008 </option>
	<option value='/blog/2008/10/'> October 2008 </option>
	<option value='/blog/2008/09/'> September 2008 </option>
	<option value='/blog/2008/08/'> August 2008 </option>
	<option value='/blog/2008/07/'> July 2008 </option>
	<option value='/blog/2008/06/'> June 2008 </option>
	<option value='/blog/2008/05/'> May 2008 </option>
	<option value='/blog/2008/04/'> April 2008 </option>
	<option value='/blog/2008/03/'> March 2008 </option>
	<option value='/blog/2008/02/'> February 2008 </option>
	<option value='/blog/2008/01/'> January 2008 </option>
	<option value='/blog/2007/12/'> December 2007 </option>
	<option value='/blog/2007/11/'> November 2007 </option>
	<option value='/blog/2007/10/'> October 2007 </option>
	<option value='/blog/2007/09/'> September 2007 </option>
	<option value='/blog/2007/08/'> August 2007 </option>
	<option value='/blog/2007/07/'> July 2007 </option>
	<option value='/blog/2007/06/'> June 2007 </option>
	<option value='/blog/2007/05/'> May 2007 </option>
	<option value='/blog/2007/04/'> April 2007 </option>
	<option value='/blog/2007/03/'> March 2007 </option>
	<option value='/blog/2007/02/'> February 2007 </option>
	<option value='/blog/2007/01/'> January 2007 </option>
	<option value='/blog/2006/12/'> December 2006 </option>
	<option value='/blog/2006/11/'> November 2006 </option>
	<option value='/blog/2006/10/'> October 2006 </option>
	<option value='/blog/2006/09/'> September 2006 </option>
	<option value='/blog/2006/08/'> August 2006 </option>
	<option value='/blog/2006/07/'> July 2006 </option>
	<option value='/blog/2006/06/'> June 2006 </option>
	<option value='/blog/2006/05/'> May 2006 </option>
	<option value='/blog/2006/04/'> April 2006 </option>
	<option value='/blog/2006/03/'> March 2006 </option>
	<option value='/blog/2006/02/'> February 2006 </option>
		</select>
</div></div><div id="categories-2" class="sidebox widget widget_categories"><div class="hd"><h2>Categories</h2></div><div class="bd">		<ul>
	<li class="cat-item cat-item-69"><a href="/blog/category/accessibility/" >Accessibility</a> (25)
</li>
	<li class="cat-item cat-item-524"><a href="/blog/category/css-101/" >CSS 101</a> (8)
</li>
	<li class="cat-item cat-item-1"><a href="/blog/category/design/" title="This category is for design related posts. For example, all posts about the design pattern library belong here.">Design</a> (51)
</li>
	<li class="cat-item cat-item-2"><a href="/blog/category/development/" title="For development related posts, including all posts about the Yahoo! User Interface Library.">Development</a> (653)
</li>
	<li class="cat-item cat-item-219"><a href="/blog/category/frontend-engineering-jobs-at-yahoo/" >Frontend Jobs at Yahoo</a> (13)
</li>
	<li class="cat-item cat-item-96"><a href="/blog/category/graded-browser-support/" >Graded Browser Support</a> (8)
</li>
	<li class="cat-item cat-item-11"><a href="/blog/category/in-the-wild/" title="In which we mention and link to third-party tutorials, discussions, comments, feedback, and implementations.">In the Wild</a> (63)
</li>
	<li class="cat-item cat-item-403"><a href="/blog/category/miscellany/" >Miscellany</a> (13)
</li>
	<li class="cat-item cat-item-483"><a href="/blog/category/open-hours/" >Open Hours</a> (44)
</li>
	<li class="cat-item cat-item-13"><a href="/blog/category/performance/" >Performance</a> (23)
</li>
	<li class="cat-item cat-item-598"><a href="/blog/category/releases/" >Releases</a> (50)
</li>
	<li class="cat-item cat-item-592"><a href="/blog/category/target-environments/" >Target Environments</a> (11)
</li>
	<li class="cat-item cat-item-599"><a href="/blog/category/yeti-development/" >Yeti</a> (5)
</li>
	<li class="cat-item cat-item-292"><a href="/blog/category/yui-3-gallery/" >YUI 3 Gallery</a> (34)
</li>
	<li class="cat-item cat-item-286"><a href="/blog/category/yui-events/" >YUI Events</a> (48)
</li>
	<li class="cat-item cat-item-8"><a href="/blog/category/yui-implementations/" >YUI Implementations</a> (55)
</li>
	<li class="cat-item cat-item-9"><a href="/blog/category/yui-theater/" >YUI Theater</a> (164)
</li>
	<li class="cat-item cat-item-595"><a href="/blog/category/yui-weekly/" >YUI Weekly</a> (76)
</li>
	<li class="cat-item cat-item-602"><a href="/blog/category/yui-conf/" title="Posts pertaining to YUIConf - videos, notices, updates.">YUIConf</a> (27)
</li>
		</ul>
</div></div>

</div></div>
		</div><!-- /#bd -->
		<div id="ft">
			<footer>
				<div class="copyright">
			&copy; 2014 YUI Blog				</div>
			</footer></div></div><!-- /#doc -->

</body>
</html>
