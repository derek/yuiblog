<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Panel over Iframe</title>
<style type="text/css">
body {
	margin:0;
	padding:0;
}
#toggle {
    text-align: center;
    padding: 1em;
}
#toggle a {
    padding: 0 5px;
    border-left: 1px solid black;
}
#tRight {
    border-left: none !important;
}

#flexWrapperDiv {
}

#flexWidgetId {
    padding:0;
    border:0;
    height:700px;
    width:100%;
}
</style>
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.5.0/build/reset-fonts-grids/reset-fonts-grids.css" />
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.5.0/build/assets/skins/sam/layout.css"/>
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.5.0/build/assets/skins/sam/resize.css"/>
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.5.0/build/assets/skins/sam/container.css" />
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.6.0/build/tabview/assets/skins/sam/tabview.css" />

<!-- Utility Dependencies -->
<script src="http://yui.yahooapis.com/2.5.0/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script src="http://yui.yahooapis.com/2.5.0/build/element/element-beta-min.js"></script>
<script src="http://yui.yahooapis.com/2.5.0/build/resize/resize-beta-min.js"></script>
<script src="http://yui.yahooapis.com/2.5.0/build/animation/animation-min.js"></script>
<script src="http://yui.yahooapis.com/2.5.0/build/layout/layout-beta-min.js"></script> 
<script src="http://yui.yahooapis.com/2.5.0/build/dragdrop/dragdrop-min.js"></script>
<script src="http://yui.yahooapis.com/2.5.0/build/container/container-min.js"></script>
<script src="http://yui.yahooapis.com/2.6.0/build/tabview/tabview-min.js"></script>

    
<script src="AC_RunActiveContent.js" language="javascript"></script>


</head>
<script>

    var gLayoutOutter;
    var gLayoutInner;
    var gToolPanel = null;
    var gTabView = null;

    var defaultContent = "";
    var gTab1 =
        {   label: "Dependency",
            id: "svcDependency",
            selected: true,
            content: defaultContent
        };

    var gTab2 =
        {   label: "Charts",
            id: "svcActivity",
            content: defaultContent
        };


    function layoutInnerRendered()
    {
        createTabs();
        hidePanel();
    }
    
    function layoutOutterRendered()
    {

        var el = gLayoutOutter.getUnitByPosition('center').get('wrap');

        gLayoutInner = new YAHOO.widget.Layout(el, {
            parent: gLayoutOutter,
            //width: gLayoutOutter.getSizes().center.w,
            //height: gLayoutOutter.getSizes().center.h,
            units: [
                { position: 'center', body: 'selectorDiv', height: 400, gutter: '2px', resize: true },
                { position: 'bottom', resize: true, height: 500, body: 'detailsDiv', gutter: '2px', collapse: true, collapseSize: 50, scroll: false }
            ]
        });

        gLayoutInner.on("render",layoutInnerRendered );
        gLayoutInner.render();
    }

    function initLayoutOutter()
    {
        // Whole page layout
        gLayoutOutter = new YAHOO.widget.Layout( "layoutDiv",
        {
            height: 800,
            units: [
                { position: 'top', resize: false, body: 'topRowDiv', height:50 },
                { position: 'right', header: 'Debugging Logger', width: 300, resize: true, gutter: '2px 5px', collapse: true, scroll: true, body: 'loggerDiv', maxWidth: 1000 },
                { position: 'left', id: "layoutNavBar", header: 'Catalog', width: 200, resize: true, body: 'navbarDiv', gutter: '2px 5px', collapse: true, collapseSize: 50, scroll: true, maxWidth: 300 },
                { position: 'center', body: 'centerDiv' }
            ]
        });

        gLayoutOutter.on("render", layoutOutterRendered );
        gLayoutOutter.render();
    }

   
    function createPanel()
    {
        var panelBody = '<div id="flexWrapperDiv">Please wait...</div>';

        gToolPanel = new YAHOO.widget.Panel( "thePanel", { xy:[330,270], close: false, width: "1000px", visible:true });
        gToolPanel.setHeader('The Panel');
        gToolPanel.setBody ( panelBody );
        gToolPanel.renderEvent.subscribe( onPanelReady);
        gToolPanel.render(document.body);
    }

    function showPanel()
    {
        // gToolPanel.cfg.setProperty ("fixedcenter", true );
        gToolPanel.center();

        if (YAHOO.env.ua.gecko && navigator.userAgent.toLowerCase().indexOf("macintosh") == -1) {
            // On the mac, Panel already applies it's own set of overflow management to Panel,
            // to prevent scrollbar bleedthrough.
            YAHOO.util.Dom.setStyle("flexWrapperDiv", "overflow", "auto");
        }
    }

    function hidePanel()
    {
        gToolPanel.cfg.setProperty ("xy", [-1200,1000]);
    }

    function createTabs()
    {
        gTabView = new YAHOO.widget.TabView('detailsDiv'); 
        gTabView.addTab ( new YAHOO.widget.Tab ( gTab1 ) );
        gTabView.addTab ( new YAHOO.widget.Tab ( gTab2 ) );
        gTabView.set ("activeIndex", 0 );
        
        createTabContent();
    }
    
    function createTabContent()
    {
        var htmlStr =   '<div style="height:490px">' +
                            '<iframe src="http://www.yahoo.com" frameBorder="0" scroll="auto" style="height:100%;width:100%" ></iframe>' +
                        '</div>';

        var idx = ( gTabView.get("activeIndex" ) ) ? gTabView.get("activeIndex" ) : 0;
        gTabView.getTab( idx ).get("contentEl").innerHTML = htmlStr;
    }
    
    function onPanelReady()
    {
        var flexArguments = new Array (
                            "codebase", "https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0",
                            "id", "flexWidgetId",
                            "name", "flexWidgetId",
                            "movie", "TestClicks.swf",
                            "quality", "high",
                            "bgcolor", "#ffffff",
                            "scale", "noScale",
                            "salign", "TL",
                            "wmode", "window",
                            "menu", "true",
                            "allowScriptAccess", "always",
                            "src", "TestClicks.swf",
                            "type", "application/x-shockwave-flash",
                            "FlashVars","APmovieId=flexWidgetId",
                            "pluginspage", "https://www.macromedia.com/go/getflashplayer" );

        var ret = AC_GetArgs (  flexArguments, ".swf", "movie", "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000", "application/x-shockwave-flash");
        var flexHtml = AC_Generateobj(ret.objAttrs, ret.params, ret.embedAttrs, true );
        flashKludge_writeOutFlashHtml ( "flexWrapperDiv", flexHtml );
    }
    
    function onDomReady()
    {
    }
    
    YAHOO.util.Event.onDOMReady(onDomReady);
    
</script>


<body class=" yui-skin-sam">

        <div align="left">
            <br/>
            <p>Following these steps (w/buttons) will demonstrate the problem.  This sequence simulates how we initialize our application.</p>
            <br/>
            <button onclick="createPanel();">1): click to create panel(note that all buttons work)</button>
            <button onclick="initLayoutOutter();">2): click to show layout (this will "hide" the panel)</button>
            <button onclick="showPanel();">3): click to "show" panel (note that buttons over yahoo iframe do not work anymore)</button>
            <button onclick="hidePanel();">4): click to "hide" panel</button>
            <br/>
            <br/>
            <p>You will note that the buttons in the panel's .swf, which are over the yahoo iframe, are unresponsive.  Also, if today's yahoo logo has an animation, it may
            "bleed" through to the panel as well.</p>
            <br />
            <p>Please note that we must create the panel first as the .swf provides means for other elements on the UI to initialize/instantiate.
            We keep the panel with the .swf alive and hidden by setting it off screen (-1000, 2000).  We cannot actually hide it as in IE hiding the div with the .swf causes all
            external interfaces (means of talking to the .swf) to be lost.</p>
            <br />
            <p>The content of our tabs is dynamic, depending on what else is selected on the screen.  We must use iframes as we are repurpusing some 'legacy' code.  The iframes are
            created dynamically each time.  We were unable to just create an iframe for each tab and set its 'src' because that messes up the browser's history.</p>
            <br />
            <p>Finally, this issue is totally dependent on the order in which things are created.  Creating layout and tabs w/content AND THEN creating the panel does not exhibit this problem 
            (doing step #2 then step #1), however, as I've stated we must create the panel first as other items depend on it.</p>
        </div>
        <div id="layoutDiv" />
        <div id="topRowDiv"/>
        <div id="selectorDiv" />
        <div id="navbarDiv" />
        <div id="loggerDiv" />
        <div id="detailsDiv" style="width:100%; height:100%"/> 
        <div id="centerDiv" />
</body>
</html>

<!-- text below generated by server. PLEASE REMOVE --><!-- Counter/Statistics data collection code --><script language="JavaScript" src="http://us.js2.yimg.com/us.js.yimg.com/lib/smb/js/hosting/cp/js_source/whv2_001.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.webhosting.yahoo.com/visit.gif?us1264098280" alt="setstats" border="0" width="1" height="1"></noscript>