<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">

<head profile="http://gmpg.org/xfn/11">

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta name="viewport" content="width=960" id="meta-viewport">
    <script>
    if (screen.width < 768) {
        document.getElementById('meta-viewport').setAttribute('content', 'width=768');
    }
    </script>


	
	<title>
		     YUI 3 Gallery Archive - YUI Blog - page 2	</title>

	<link rel="shortcut icon" href="/yuiblog/favicon.ico" type="image/x-icon" />

	<!-- IMPORT: yuilibrary.com -->
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic">
	<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.5.1/build/cssgrids/cssgrids-min.css">
	<link rel="stylesheet" type="text/css" href="http://yuilibrary.com/combo/main-min.css">
	<link ref="stylesheet" type="text/css" href="http://yuilibrary.com/vendor/prettify/prettify-min.css">
	<link ref="stylesheet" type="text/css" href="http://yuilibrary.com/css/docs-min.css">
	<!-- /IMPORT -->


	<link rel="stylesheet" href="/yuiblog/blog/wp-content/themes/yuilibraryv2/style.css" type="text/css" />

	<link rel="pingback" href="/yuiblog/blog/xmlrpc.php" />

	
        <script>var YUI_config={"filter":"min","maxURLLength":1024,"groups":{"site":{"combine":true,"comboBase":"/combo/js?","root":"","modules":{"hoverable":{"path":"hoverable-min.js","requires":["event-hover","node-base","node-event-delegate"]},"search":{"path":"search-min.js","requires":["autocomplete","autocomplete-highlighters","node-pluginhost"]},"api-filter":{"path":"apidocs/api-filter-min.js","requires":["autocomplete-base","autocomplete-highlighters","autocomplete-sources"]},"api-list":{"path":"apidocs/api-list-min.js","requires":["api-filter","api-search","event-key","node-focusmanager","tabview"]},"api-search":{"path":"apidocs/api-search-min.js","requires":["autocomplete-base","autocomplete-highlighters","autocomplete-sources","escape"]}}}}};</script>

        <script src="http://yui.yahooapis.com/3.5.1/build/yui/yui-min.js"></script>

	<link rel="alternate" type="application/rss+xml" title="YUI Blog &raquo; Feed" href="/yuiblog/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="YUI Blog &raquo; Comments Feed" href="/yuiblog/blog/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="YUI Blog &raquo; YUI 3 Gallery Category Feed" href="/yuiblog/blog/category/yui-3-gallery/feed/" />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js?ver=3.8.2'></script>

    <!-- GOOGLE ANALYTICS SCRIPT.
        When changing themes, be sure to copy/paste this script from this theme to the new theme.
    -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-34018865-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

<style>
        /* Site Header */
        #hd {
            padding: 25px 20px 20px;
        }
        #hd .site-header {
            display: flex;
            align-items: center;
        }
        #hd .site-brand {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        #hd .site-logo img {
            height: 52px;
            width: auto;
        }
        #hd .site-title {
            margin: 0;
            font-size: 32px;
            color: #30418C;
            line-height: 1.2;
            letter-spacing: normal;
        }
        #hd .site-title a {
            color: inherit;
            text-decoration: none;
        }
        #hd .site-tagline {
            margin: 5px 0 0;
            font-size: 15px;
            color: #666;
            letter-spacing: normal;
        }
    </style>
</head>

<body class="archive paged category category-yui-3-gallery category-292 paged-2 category-paged-2 yui3-skin-sam">

	<div id="doc">
	      <div id="hd" class="yui3-g">
			<header>
	     <div class="content">
	     <div class="yui3-u-3-4">
               <a href="//yuilibrary.com/" rel="home"><div id="hd-logo" role="image" aria-label="YUI logo"></div></a>
             </div>
	     <div class="yui3-u-1-4">
		    	<div id="topsearch" style="position: relative; left: -40px; top: 35px;">
<form action="/yuiblog/blog" id="main-search" class="search" method="get">
        <input type="search" class="search-input" style="width: 200px; font-size:10px;" placeholder="Search the blog" id="s" name="s" value="" />
</form>
</div>	     </div>

	     <div id="main-nav" class="yui3-u"><nav>
              <ul class="nav hoverable-group">

            <li class="nav-tab hoverable  nav-tab-active">
                <a href="http://yuilibrary.com">Home</a>

            </li>

            <li class="nav-tab hoverable ">
                <a href="http://yuilibrary.com/yui/quick-start/">Quick Start</a>

                    <ul class="nav-submenu">

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/yui/configurator/">Configurator</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/download/yui3/">Download YUI 3</a>

                            </li>

                    </ul>

            </li>

            <li class="nav-tab hoverable ">
                <a href="http://yuilibrary.com/yui/docs/">Documentation</a>

                    <ul class="nav-submenu">

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/yui/docs/guides/">User Guides</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/yui/docs/examples/">Examples</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/yui/docs/tutorials/">Tutorials</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/yui/docs/api/">API Docs</a>

                            </li>

                    </ul>

            </li>

            <li class="nav-tab hoverable nav-break">
                <a href="http://yuilibrary.com/community/">Community</a>

                    <ul class="nav-submenu">

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/gallery/">Gallery</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="/yuiblog/" title="YUI Blog">Blog</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/forum/">Forums</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/theater/">YUI Theater</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/yui3/calendar/">Calendar</a>

                            </li>

                    </ul>

            </li>

            <li class="nav-tab hoverable ">
                <a href="http://yuilibrary.com/contribute/">Contribute</a>

                    <ul class="nav-submenu">

                            <li class="nav-child ">

                                    <a href="https://github.com/yui/" target="_blank" title="External link">YUI on GitHub &#187;</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/yui3/newticket/">File a Ticket</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/yui3/report/">View Tickets</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/yui3/dashboard/">Dashboard</a>

                            </li>

                    </ul>

            </li>

            <li class="nav-tab hoverable ">
                <a href="http://yuilibrary.com/projects/">Other Projects</a>

                    <ul class="nav-submenu">

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/yui2/">YUI 2</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/yuicompressor/">YUI Compressor</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yui.github.com/yuidoc" target="_blank" title="External link">YUI Doc &#187;</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/builder/">YUI Builder</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/phploader/">YUI PHP Loader</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/yuitest/">YUI Test</a>

                            </li>

                            <li class="nav-child ">

                                    <a href="http://yuilibrary.com/projects/yuilibrary/">YUI Website</a>

                            </li>

                    </ul>

            </li>

    </ul>
			</nav>
                         </div>
			 </div>
			</header>
		</div>
		<div id="bd" class="clearfix yui3-g">
<div class="yui3-u-3-4 print-max-width">
<div id="docs-main" class="content">

		<ul class="breadcrumbs"><li class="front_page"><a href="//yuilibrary.com/">YUI</a></li><li><a href="/blog">Blog</a></li>YUI 3 Gallery<li></li></ul>

		
 			
							<h1>Blog: Category &#8216;YUI 3 Gallery&#8217;</h1>

			
							<div class="navigation yui3-g">
	<div class="next-posts yui3-u"><a href="/yuiblog/blog/category/yui-3-gallery/page/3/" >&laquo; Older Entries</a></div>
            <span class="greyed nav-separator">|</span> 
    	<div class="prev-posts yui3-u-1-2">
        <a href="/yuiblog/blog/category/yui-3-gallery/" >Newer Entries &raquo;</a>    </div>
</div>			
									
								<div class="post-3634 post type-post status-publish format-standard hentry category-development category-yui-3-gallery first-post">
				
						<h2 id="post-3634"><a href="/yuiblog/blog/2011/05/06/in-the-yui-3-gallery-geo/">In the YUI 3 Gallery: Geo</a></h2>
					

						<div class="entry">
							<p>Geolocation is one of the more exciting HTML5-related technologies to appear in browsers, and the <a href="http://yuilibrary.com/gallery/show/geo">Geo</a> Gallery module gives you access to location information. The <a href="http://dev.w3.org/geo/api/spec-source.html">W3C Geolocation API</a> provides a simple interface to access the user&#8217;s location from JavaScript. The following code accesses the user&#8217;s current location in a supporting browser:</p>
<pre><code>navigator.geolocation.getCurrentPosition(function(result) {
    //success handler
}, function (result){
    //failure handler
})</code></pre>
<p>When this code is executed, the browser pops up a message asking for the user&#8217;s permission to reveal their current location. The dialog displayed in Firefox looks like this:</p>
<p><img src="/yuiblog/blog/wp-content/uploads/2011/05/geo.png" alt="Geolocation dialog in Firefox" width="379" height="168"></p>
<p>If the user denies permission, or an error occurs while trying to get the current position, the failure handler is called. Otherwise, the success handler is called with information about the current location. That information comes in the form of latitude and longitude coordinates (other information may be available as well, depending on the implementation).</p>
<p>The W3C Geolocation API is supported in Internet Explorer 9+, Firefox 3.5+, Safari 5+, Chrome, and Opera 10.6 as well as on Mobile Safari and Webkit on Android, making it fairly ubiquitous. </p>
<p>The Geo module uses the Geolocation API when it&#8217;s available, and falls back to an IP-based lookup via the YQL <a href="http://geoip.pidgets.com/">pidgets.geoip</a> open table when not available or if there is an error. This table is exceptionally useful because you can lookup location information for a specific IP address, or you can omit the IP address and it will return the location information for the IP address making the request. The latter part ensures that you need to make only one request to get location information instead of two (other solutions use one to get the IP address and then one to get the location information for that IP address).</p>
<p>In typical YUI fashion, the Geo module provides a streamlined interface for accessing geolocation information. Instead of providing two callback functions, one for success and one for failure, just pass in one. The result object has a <code>success</code> property indicating if the call succeeded:</p>
<pre><code>YUI({
    gallery: 'gallery-2011.04.27-17-14'
}).use('gallery-geo', function(Y) {
 
    Y.Geo.getCurrentLocation(function(response){
 
        //check to see if it was successful
        if (response.success){
            console.log(response.coords.latitude);
            console.log(response.coords.longitude);
        }
 
    });
 
});</code></pre>
<p>When a geolocation call completes successfully, the <code>success</code> property is true and <code>response.coords</code> is filled with at least two properties: <code>latitude</code> and <code>longitude</code> (if the native API is used, then all available properties are copied to this object). There is also a  <code>source</code> property on the response object that is either &#8220;native&#8221;, if the information was retrieved from the native API, or &#8220;pidgets.geoip&#8221;, if it was retrieved by YQL. If an error occurs, or if the user declines to provide location information, then <code>success</code> is false. </p>
<p>If the Geolocation API has an error, the Geo module will try IP-based lookup instead. If, however, the user declines to provide information, the IP-based lookup is not performed.</p>
<p>Keep in mind that the native API is much more accurate than IP location, so you won&#8217;t get the same quality results in browsers without native geolocation support. However, the Geo module is a good first step to providing location-based experiences to your users.</p>
						</div>

						<div class="meta">
    <img src="http://www.gravatar.com/avatar/f071cb9c72c08020c83a0838b192145a?s=32"> <div class="cont"><a href="http://nczonline.net" class="name">By Nicholas C. Zakas</a><span class="date">May 6th, 2011<span></div></div>
				</div>
										
								<div class="post-3500 post type-post status-publish format-standard hentry category-development category-yui-3-gallery tag-datatable tag-inline-editing tag-jafl tag-yui-3">
				
						<h2 id="post-3500"><a href="/yuiblog/blog/2011/04/19/quickedit-datatable-yui3/">Quick Edit mode for YUI 3 DataTable</a></h2>
					

						<div class="entry">
							<p>Even though <a href="http://developer.yahoo.com/yui/3/datatable/">YUI 3 DataTable</a> does not yet have inline editing of individual cells, it is relatively simple to implement Quick Edit mode.  The <a href="http://yuilibrary.com/gallery/show/quickedit">QuickEdit</a> plugin for DataTable in the <a href="http://yuilibrary.com/gallery/">YUI 3 Gallery</a> allows all the visible values in a DataTable to be edited simultaneously.</p>
<p><a href="http://jafl.github.com/yui3-gallery/quickedit/" title="YUI 3 Quick Edit Screenshot"><img src="http://jafl.github.com/yui3-gallery/quickedit/example.png"></a></p>
<p>(<a href="http://jafl.github.com/yui3-gallery/quickedit/" title="YUI 3 Quick Edit Example">Click the screenshot to play with this example</a>.)</p>
<h3>Overview</h3>
<p>As with the <a href="/yuiblog/blog/2010/08/19/quickedit-datatable/">YUI 2 version</a>, the core idea of Quick Edit mode is to swap out all the cell formatters with new ones which populate the cells with form elements, e.g., input fields or dropdowns.  This is done when <code>start()</code> is called, based on the configuration described below.  After the user is finished, you can call <code>getChanges()</code> to get the changed values and then persist them.  To exit Quick Edit mode, call <code>cancel()</code>.  (It is named <q>cancel</q> instead of <q>stop</q> to remind you that it <em>discards</em> all changes.)</p>
<p>Since the Quick Edit gallery module is a plugin for DataTable, you need to plug it in to your datatable before you can use it:</p>
<pre>
my_table.plug(Y.Plugin.DataTableQuickEdit);
</pre>
<p>This stores the plugin in the <code>qe</code> member of the datatable, so you must call the plugin&#8217;s functions like this:</p>
<pre>
my_table.qe.start();
</pre>
<h3>Configuration</h3>
<p>Quick Edit adds two new configuration attributes to all columns: <code>quickEdit</code> and <code>qeFormatter</code>.</p>
<p>If a column&#8217;s <code>quickEdit</code> property is defined, the column will be editable in Quick Edit mode.  To accept all the defaults, you can simply set <code>quickEdit:true</code>.  For more control, you can pass an object with the following properties:</p>
<dl>
<dt><code>formatter</code></dt>
<dd>
<p style="margin:0">The cell formatter which will render an appropriate form field: &lt;input type=&#8221;text&#8221;&gt;, &lt;textarea&gt;, or &lt;select&gt;.  By default, the cell formatter <code>Y.Plugin.DataTableQuickEdit.textFormatter</code> is used for all cells to produce input elements.  To get a <code>textarea</code> element, configure a column to use <code>Y.Plugin.DataTableQuickEdit.textareaFormatter</code> instead.</p>
</dd>
<dt><code>validation</code></dt>
<dd>
<p style="margin:0">Validation configuration for every field in the column.</p>
<dl>
<dt><code>css</code></dt>
<dd>
<p style="margin:0">CSS classes encoding basic validation rules:</p>
<dl>
<dt><code>yiv-required</code></dt>
<dd>
<p style="margin:0">Value must not be empty.</p>
<dt><code>yiv-length:[x,y]</code></dt>
<dd>
<p style="margin:0">String must be at least <code>x</code> characters and at most <code>y</code> characters. At least one of x and y must be specified.</p>
<dt><code>yiv-integer:[x,y]</code></dt>
<dd>
<p style="margin:0">The integer value must be at least <code>x</code> and at most <code>y</code>. <code>x</code> and <code>y</code> are both optional.</p>
<dt><code>yiv-decimal:[x,y]</code></dt>
<dd>
<p style="margin:0">The decimal value must be at least <code>x</code> and at most <code>y</code>. Exponents are not allowed. <code>x</code> and <code>y</code> are both optional.</p>
</dl>
</dd>
<dt><code>fn</code></dt>
<dd>
<p style="margin:0">A function that will be called with the DataTable as its scope and the cell&#8217;s form element as the argument. Return true if the value is valid. Otherwise, call <code>this.displayMessage(...)</code> to display an error and then return false.</p>
</dd>
<dt><code>msg</code></dt>
<dd>
<p style="margin:0">A map of types to messages that will be displayed when a basic or regex validation rule fails. The valid types are: <code>required</code>, <code>min_length</code>, <code>max_length</code>, <code>integer</code>, <code>decimal</code>, and <code>regex</code>.  There is no default for type <code>regex</code>, so you must specify a message if you configure a regex validation.  The default error messages for the other types are stored in <code>Y.FormManager.Strings</code> (provided by <a href="http://yuilibrary.com/gallery/show/formmgr-css-validation">gallery-formmgr-css-validation</a>) and can be overridden and/or localized.</p>
</dd>
<dt><code>regex</code></dt>
<dd>
<p style="margin:0">Regular expression that the value must satisfy in order to be considered valid.</p>
</dd>
</dl>
</dd>
</dl>
<p>Sometimes, a non-editable column must be rendered differently during Quick Edit mode.  The best example is a column containing a link, since navigating away from the page while in Quick Edit mode can be disastrous.  To remove the link during Quick Edit, configure <code>qeFormatter</code> for the column to be <code>Y.Plugin.DataTableQuickEdit.readonlyLinkFormatter</code>.  For email addresses, use <code>Y.Plugin.DataTableQuickEdit.readonlyEmailFormatter</code>.  You can also write you own custom, read-only formatter.  Simply follow the normal rules for constructing a DataTable cell formatter.</p>
<h3>Missing Features</h3>
<p>Due to a <a href="http://yuilibrary.com/projects/yui3/ticket/2529839">bug in YUI 3.3.0 DataTable</a>, the <code>td</code> element passed to a column formatter is actually from the <em>previous</em> column.  This made it too troublesome to support <q>copy down</q>, where a button in the first row lets you copy the value down to all other rows.</p>
<p>The bug also required a complete reworking of the basic Quick Edit cell formatters to return text instead of manipulating the DOM.  This is why custom cell formatters are not officially supported in this initial release.  If you are adventurous, you can still build them, but keep in mind that you will need to rewrite them, including adding in support for <q>copy down,</q> once the bug in DataTable is fixed.</p>
<p class="authorbox"><em><strong>About the author:</strong> <a href="http://jjlindal.net/jafl/blog/">John Lindal</a> (<a href="http://twitter.com/jafl5272/">@jafl5272</a> on Twitter) is one of the lead engineers constructing the foundation on which <a href="http://apt.yahoo.com/">Yahoo! APT</a> is built.  Previously, he worked on the Yahoo! Publisher Network.</em></p>
						</div>

						<div class="meta">
    <img src="http://www.gravatar.com/avatar/38f9e2bde80f6645036885d233609d69?s=32"> <div class="cont"><a href="http://jafl.my.speedingbits.com/blog/" class="name">By John Lindal</a><span class="date">April 19th, 2011<span></div></div>
				</div>
										
								<div class="post-3284 post type-post status-publish format-standard hentry category-development category-yui-3-gallery tag-datatable tag-filter tag-jafl tag-querybuilder tag-yui-3">
				
						<h2 id="post-3284"><a href="/yuiblog/blog/2011/03/01/filtering-yui3-datatable/">Filtering the Data Displayed by YUI 3 DataTable</a></h2>
					

						<div class="entry">
							<p>In addition to sorting, which is supported by <a href="http://developer.yahoo.com/yui/3/datatable/">YUI 3 DataTable</a>, it is often useful to be able to filter the data and display a subset of the available rows.  The <a href="http://yuilibrary.com/gallery/show/querybuilder">Query Builder</a> widget in the <a href="http://yuilibrary.com/gallery/">YUI 3 Gallery</a> provides a UI for constructing a simple filter expression.</p>
<p><a href="http://jafl.github.com/yui3-gallery/querybuilder/"><img src="http://jafl.github.com/yui3-gallery/querybuilder/example.gif"></a></p>
<p>(<a href="http://jafl.github.com/yui3-gallery/querybuilder/" title="YUI 3 Query Builder Example">Click the screenshot to play with this example</a>.)</p>
<h3>History</h3>
<p>The first version was written by a colleague working with me on the Yahoo! Publisher Network (YPN).  (He left soon afterwards to attempt honest employment.  Following the precedent set by Jamie Zawinski, he opened a pub to sell beer &#8212; home brewed, no less!  But I digress&#8230;.)  After hacking together the first version of Query Builder, he made the mistake of showing it to me.  A few days later, he complained, &#8220;You rewrote the whole thing!&#8221;  In fact, I have rewritten it several times over the years.  YPN is gone, but the latest YUI 2 version of Query Builder powers all data tables in <a href="http://apt.yahoo.com/">APT</a>, Yahoo&#8217;s display advertising management platform.  The port to YUI 3 is actually the least amount of work I have had to do to generate a new version!</p>
<h3>How the example works</h3>
<p>The core of the example is (1) the Query Builder configuration which specifies how the user can filter the data and (2) the extension to Y.DataSource.Local which implements the filter.  (For server side pagination, you would send the filter data to the server and bake it into your SQL query.)</p>
<p>To configure Query Builder, the example first defines a list of the variables that can be filtered:</p>
<pre>
var var_list =
[
	{
		name: 'title',
		type: 'string',
		text: 'Title'
	},
	{
		name: 'year',
		type: 'number',
		text: 'Year',
		validation: 'yiv-integer:[0,2100]'
	},
	{
		name: 'quantity',
		type: 'number',
		text: 'Quantity',
		validation: 'yiv-integer:[0,]'
	}
];
</pre>
<p>Each variable is assigned a name (matching the key in the DataTable column configuration) and a type.  The default types are &#8216;string&#8217;, &#8216;number&#8217;, and &#8216;select&#8217;, but you can extend this by building custom plugins (<a href="#plugins">see below</a>).  For each type that you use, you must also define a set of operators:</p>
<pre>
var ops =
{
	string:
	[
		{ value: 'contains',    text: 'Contains' },
		{ value: 'starts-with', text: 'Starts with' },
		{ value: 'ends-with',   text: 'Ends with' }
	],

	number:
	[
		{ value: 'equal',   text: '=' },
		{ value: 'less',    text: '&lt;=' },
		{ value: 'greater', text: '&gt;=' }
	]
};
</pre>
<p>This specifies the operators that the user can apply to each variable type.  (If you need different sets of operators for variables of the same fundamental type, you can clone the type.  See the <a href="#plugins">Plugins</a> section below.)</p>
<p><a href="http://yuilibrary.com/gallery/show/formmgr">Y.FormManager</a> is used to validate the values entered by the user before the filter is applied.  The <q>validation</q> key for each variable in the above Query Builder configuration provides CSS data which is interpreted by Y.FormManager.</p>
<p>If all validations pass, a request is sent to the data source.  The extension to <code>Y.DataSource.Local</code> is quite simple.  It merely filters the data before returning the results:</p>
<pre>
Y.extend(CustomDataSource, Y.DataSource.Local,
{
	_defDataFn: function(e)
	{
		var data = filterData(e.data, e.request.filter);
		var response =
		{
			results: data.slice(e.request.recordOffset,
						e.request.recordOffset + e.request.rowsPerPage),
			meta:
			{
				totalRecords: data.length
			}
		};

		this.fire("response", Y.mix({response: response}, e));
	}
});
</pre>
<p>The <code>filter</code> element of the request is obtained from <a href="http://jafl.github.com/yui3-gallery/querybuilder/yuidoc/QueryBuilder.html#method_toDatabaseQuery"><code>QueryBuilder.toDatabaseQuery()</code></a>, which returns a list of <code>[variable, operator, value]</code> tuples.  Also note that the response must include information on the total number of records, since this changes based on the filter being applied.</p>
<p><code>filterData()</code> simply loops over the tuples from <code>toDatabaseQuery()</code>, applying the filter operators defined in a two level lookup table:</p>
<pre>
var filters =
{
	string:
	{
		contains: function(value, filter)
		{
			return (value.indexOf(filter) &gt;= 0);
		},
		'starts-with': function(value, filter)
		{
			return (value.substr(0, filter.length) == filter);
		},
		'ends-with': function(value, filter)
		{
			return (value.substr(-filter.length) == filter);
		}
	},

	number:
	{
		equal: function(value, filter)
		{
			return (parseInt(value, 10) == parseInt(filter, 10));
		},
		less: function(value, filter)
		{
			return (parseInt(value, 10) &lt;= parseInt(filter, 10));
		},
		greater: function(value, filter)
		{
			return (parseInt(value, 10) &gt;= parseInt(filter, 10));
		}
	}
};
</pre>
<p>After all this, DataTable simply displays what it receives from the data source.</p>
<h3 id="plugins">Plugins</h3>
<p><a href="http://jafl.github.com/yui3-gallery/querybuilder/yuidoc/Types.js.html"><code>Y.QueryBuilder.plugin_mapping</code></a> defines the mapping of type names to actual classes.  You can augment this mapping in two ways:</p>
<ol>
<li>Clone an existing type by defining a new name for the same class.  This allows different sets of operators for different variables of the same fundamental type.</li>
<li>Create a new type by implementing the <a href="http://jafl.github.com/yui3-gallery/querybuilder/yuidoc/QueryBuilder.html">plugin API</a>.  Studying the source code for the existing plugins is the best way to get a feel for how this API works.  </li>
</ol>
<h3>Generalizing Query Builder</h3>
<p>Query Builder does not support parentheses, so you can either AND all the conditions or OR all the conditions.  While it is possible to introducing parentheses into a graphical representation of a Boolean expression, all the designs that I have seen are too cumbersome to use.  A textual representation is much simpler and easier to manipulate.  <a href="http://yuilibrary.com/gallery/show/exprbuilder">Expression Builder</a> incorporates Query Builder into a widget that allows constructing a textual representation without having to remember the syntax or type everything in by hand.</p>
<p class="authorbox"><em><strong>About the author:</strong> <a href="http://jjlindal.net/jafl/blog/">John Lindal</a> (<a href="http://twitter.com/jafl5272/">@jafl5272</a> on Twitter) is one of the lead engineers constructing the foundation on which <a href="http://apt.yahoo.com/">Yahoo! APT</a> is built.  Previously, he worked on the Yahoo! Publisher Network.</em></p>
						</div>

						<div class="meta">
    <img src="http://www.gravatar.com/avatar/38f9e2bde80f6645036885d233609d69?s=32"> <div class="cont"><a href="http://jafl.my.speedingbits.com/blog/" class="name">By John Lindal</a><span class="date">March 1st, 2011<span></div></div>
				</div>
										
								<div class="post-3191 post type-post status-publish format-standard hentry category-development category-yui-3-gallery tag-datatable tag-jafl tag-treeble tag-treeview tag-yui-3">
				
						<h2 id="post-3191"><a href="/yuiblog/blog/2011/01/24/treeble-yui3-datatable/">Treeble with YUI 3 DataTable</a></h2>
					

						<div class="entry">
							<p>The beta release of <a href="http://developer.yahoo.com/yui/3/datatable/">DataTable</a> in YUI 3.3.0 gives us a very powerful component to play with.  To kick the tires in a useful way, I decided to update my <a href="http://yuilibrary.com/gallery/show/treeble">Treeble</a> examples to use DataTable.  (Treeble enables <a href="/yuiblog/blog/2010/04/14/treeble-using-nested-yui-2-datasources-for-row-expansion/">displaying hierarchical data in a table</a>.)</p>
<p>To my delight, it was a breeze!  All the hard work is done in <a href="http://jafl.github.com/yui3-gallery/treeble/yuidoc/TreebleDataSource.html"><code>TreebleDataSource</code></a>, which extends YUI 3 DataSource, so all I had to do was plug it into DataTable by using <code>Y.Plugin.DataTableDataSource</code> and then configure the columns:</p>
<blockquote>
<pre>
var ds = new Y.TreebleDataSource(...),
	pg = new Y.Paginator(...),
	table;

function sendRequest() {
	table.datasource.load({
		request: {
			startIndex:  pg.getStartIndex(),
			resultCount: pg.getRowsPerPage()
		}
	});
}

var cols = [
    { key: 'yui33-hack', label: '' },
    {
        key: 'treeblenub', label: '',
        formatter: Y.Treeble.buildTwistdownFormatter(sendRequest)
    },
    {
        key: 'title', label: 'Title',
        formatter: Y.Treeble.treeValueFormatter
    },
    ...
];

table = new Y.DataTable.Base({columnset: cols});
table.plug(Y.Plugin.DataTableDataSource, {datasource: ds});
</pre>
</blockquote>
<p>To see the complete source code, refer to the <a href="http://jafl.github.com/yui3-gallery/treeble/">live example</a>.</p>
<p>The only flies in the ointment are:</p>
<ul>
<li>The <q>yui33-hack</q> column.  Due to a <a href="http://yuilibrary.com/projects/yui3/ticket/2529839">bug in YUI 3.3.0 DataTable</a>, the <code>td</code> element passed to a column formatter is actually from the <em>previous</em> column.  Thus, the first column in the table displays the twistdown, and the second column is empty.</li>
<li>Undefined values in the data are displayed as <code>{value}</code> instead of blanks (<a href="http://yuilibrary.com/projects/yui3/ticket/2529858">bug 2529858</a>).</li>
</ul>
<p>In order to make Treeble easier to use, I have added a Sam skin which styles to the CSS classes written out by the <code>Y.Treeble</code> formatters.</p>
<p>Enjoy!</p>
<p class="authorbox"><em><strong>About the author:</strong> <a href="http://jjlindal.net/jafl/blog/">John Lindal</a> (<a href="http://twitter.com/jafl5272/">@jafl5272</a> on Twitter) is one of the lead engineers constructing the foundation on which <a href="http://apt.yahoo.com/">Yahoo! APT</a> is built.  Previously, he worked on the Yahoo! Publisher Network.</em></p>
						</div>

						<div class="meta">
    <img src="http://www.gravatar.com/avatar/38f9e2bde80f6645036885d233609d69?s=32"> <div class="cont"><a href="http://jafl.my.speedingbits.com/blog/" class="name">By John Lindal</a><span class="date">January 24th, 2011<span></div></div>
				</div>
										
								<div class="post-3036 post type-post status-publish format-standard hentry category-development category-yui-3-gallery tag-carousel tag-yui-3 tag-yui-3-gallery">
				
						<h2 id="post-3036"><a href="/yuiblog/blog/2010/12/13/gallery-carousel/">In the YUI 3 Gallery: The Carousel Module</a></h2>
					

						<div class="entry">
							<div class="authorbox">
<p><em><strong>About the authors:</strong> <a href="http://g13n.in/">Gopal Venkatesan</a> (<a href="http://twitter.com/g13n">@g13n</a>) works for Yahoo! in Bangalore where he is one of the deans of the frontend engineering community; Gopal has been the lead engineer on the <a href="http://developer.yahoo.com/yui/carousel/" title="YUI 2: Carousel Control">YUI 2 Carousel</a> project since the 2.6.0 release.  He is also the author of the new <a href="http://yuilibrary.com/gallery/show/carousel">YUI 3 Gallery Carousel</a> module.  <a href="http://uk.linkedin.com/in/fabianfrank87">Fabian Frank</a> hails from Germany and works for Yahoo! in Beijing; Fabian has been with Yahoo since he finished his Master&#8217;s of Research at the University of Glasgow.</em></p>
</div>
<h3>What is a Carousel?</h3>
<p>A Carousel control provides a widget for browsing among a set of like objects arrayed vertically or horizontally in an overloaded page region. The &#8220;carousel&#8221; metaphor derives from an analogy to slide carousels in the days of film photography; the Carousel control can maintain fidelity to this metaphor by allowing a continuous, circular navigation through all of the content blocks. </p>
<p>The Carousel is part of a family of widgets that allow you to &#8220;overload&#8221; a space on the page, providing more content for that space than fits within its dimensions while providing an easy, intuitive mechanism for the user to discover and navigate the additional content.  Accordions, Tabs, Trees and ScrollViews are other examples of this genre.</p>
<h3>Why yet another Carousel control?</h3>
<p>YUI 3 needs a robust, feature-rich Carousel (as we have in <a href="http://developer.yahoo.com/yui/carousel/" title="YUI 2: Carousel Control">YUI 2</a>).  The design goal for this Carousel was to make it lean and clean and add additional configurations through plugins, taking advantage of <a href="http://developer.yahoo.com/yui/3/" title="YUI 3 &mdash; Yahoo! User Interface Library">YUI 3&#8242;</a>s intrinsic support for modularity to preserve lightness and speed.</p>
<h3>YUI 3 Widget Framework</h3>
<p>One of the biggest advantages of writing custom widgets using YUI 3 is the Widget framework (more on the Widget framework: <a href="http://developer.yahoo.com/yui/3/widget/" title="YUI 3: Widget">user&#8217;s guide</a>, <a href="http://developer.yahoo.com/yui/theater/video.php?v=desai-yuiconf2009-widgets" title="Video: Satyen Desai &mdash; A Widget Walkthrough (YUI Theater)">in-depth video introduction</a>).  Comparing the <a href="http://developer.yahoo.com/yui/carousel/" title="YUI 2: Carousel Control">Carousel in YUI 2.8.2</a> to my <a href="http://yuilibrary.com/gallery/show/carousel" title="YUI Library :: Gallery :: Carousel">YUI 3 Gallery Carousel</a>, the YUI 3 version is lean and elegant.  This is because most of the heavy lifting with respect to providing the foundation providing common set of widget attributes, a disciplined lifecycle, progressive enhancement support, etc. come with the Widget class.</p>
<p>The YUI 3 Widget framework also provides a consistent MVC pattern which promotes every widget to adopt separation of state methods versus UI update methods.  This makes the code very clean and maintainable.  In fact this is one of the important factors why the YUI 3 Carousel is better than its earlier YUI 2-based cousin.</p>
<p>The <a href="http://developer.yahoo.com/yui/3/plugin/" title="YUI 3: Plugin">YUI 3 Plugin</a> model allows developers to add new functionality or modify existing behavior to objects.  This allows adding additional functionality on top of Carousel to dynamically pull elements through Ajax, etc.  So, the YUI 3 Carousel does not have animation code baked into it, but instead I have created a plugin which adds animation support for cases where it is needed. This helps to keep the component very lightweight.</p>
<h3>A Gallery Carousel for your own website</h3>
<p>After reading about what a Carousel is and how it can help you to improve your website, you hopefully feel eager to get your hands dirty.  Don&#8217;t worry, with our YUI 3 Gallery Carousel extension, implementing a carousel on your website is as easy as providing a bulleted list in HTML.  That&#8217;s not just a sales pitch — that&#8217;s how we recently integrated a Gallery Carousel into the Yahoo! Sports Search Results Page.</p>
<p><a href="http://sports.search.yahoo.com/search?p=usain+bolt&amp;fr2=sb-top&amp;fr=sports-us-ss" title="usain bolt - Yahoo! Sports Search Results"><img src="/blog-archive/assets/carousel-sports.png"></a></p>
<h3>A simple example</h3>
<p>Let&#8217;s start with a simple example that will cover almost everything you need to know.  The easiest way for you to use the new Gallery Carousel is to let YUI 3 automagically load it from Yahoo&#8217;s content delivery network.  Recalling what a Carousel is, a scrollable list of items, we create a list in HTML.  We include the list in a div, which allows our JavaScript to easily find and work with it.  If you already have some data that is represented in a list-like way in your markup, you might also just put the carousel div around it and test your luck!  It is very important to say that, although we are using an image example here, you can use Gallery Carousel for anything you want!</p>
<pre>&lt;div class=&quot;carousel&quot; id=&quot;container&quot;&gt;
  &lt;ol&gt;
    &lt;li&gt;&lt;img src=&quot;img/c1.jpg&quot;&gt;&lt;/li&gt;
    &lt;li&gt;&lt;img src=&quot;img/c2.jpg&quot;&gt;&lt;/li&gt;
    &lt;li&gt;&lt;img src=&quot;img/c3.jpg&quot;&gt;&lt;/li&gt;
    &lt;li&gt;&lt;img src=&quot;img/c4.jpg&quot;&gt;&lt;/li&gt;
    &lt;li&gt;&lt;img src=&quot;img/c5.jpg&quot;&gt;&lt;/li&gt;
    &lt;/ol&gt;
&lt;/div&gt;</pre>
<p>Now that we have our data to work with, we want to enhance the looks by showing all five items using the Carousel widget.  Assuming that you are already using YUI 3 this is a straightforward task.  The only thing that you might not have seen before, depending on how deep you have been digging into YUI 3 and the Gallery in the past, is that we are specifying a Gallery version explicitly.  This is necessary because we are using a brand new widget, which is not including in the Gallery build that YUI&#8217;s loader tries to load from by default.  However, as YUI and YUI Gallery mature, this will not be necessary anymore in the future when the default build number is being increased.</p>
<pre>YUI({gallery: 'gallery-2010.10.20-19-33'})
 .use("gallery-carousel", "gallery-carousel-anim", "substitute", function(Y) {
  var carousel = new Y.Carousel({ boundingBox: "#container",
   contentBox: "#container > ol" });
  carousel.plug(Y.CarouselAnimPlugin,{animation:{speed: 0.7}});
  carousel.render();
});</pre>
<p>(By the way, if you are interested in getting brand new stuff you can visit the <a href="https://github.com/yui/yui3-gallery">YUI 3 Gallery repository</a> on github or <a href="https://github.com/g13n/yui3-gallery/tree/master/src/gallery-carousel">Gopal&#8217;s fork</a>, where he develops Carousel.  If you find a bug, we are always happy to hear about it.)</p>
<p>Back to our example&#8230; YUI will take it from here.  The loader automatically pulls Gallery Carousel and its dependencies from Yahoo&#8217;s content delivery network.  After that, the Carousel is being initialized and displayed.  The user can then click the left or right arrow to scroll around. Please forgive me for bringing in one line of unnecessary complexity, but I couldn&#8217;t resist.  I used <code>Y.CarouselAnimPlugin</code> to let our carousel slide smoothly from one page to the other instead of just displaying the next page instantly.  Feel free to play with the speed parameter if you wish.</p>
<p><img src="/blog-archive/assets/carousel-1.png"></p>
<p>As you can see from the screenshot above, the Carousel is up and running.  However, the CSS might not fit very well into the rest of your page.  This leads us to our next section, where we&#8217;ll discuss how to customize Gallery Carousel.</p>
<h4>Customizing Gallery Carousel</h4>
<p>Now that you have your Carousel up and running and identified a use case for your website, you hopefully want to integrate it seamlessly.  As mentioned previously, we did so for our Sports Search Results Page.  If you want to increase the number of visible items, for example from three to four, you can do so by modifying the line which instantiates Carousel.</p>
<pre>var carousel = new Y.Carousel({ boundingBox: "#container",
 contentBox: "#container > ol", numVisible: 4 });</pre>
<p><img src="/blog-archive/assets/carousel-2.png"></p>
<p>Still not good enough?  Yeah, right.  Luckily CSS allows us to add our own style definitions and even overwrite the initial ones without touching any existing CSS.  So your first step will probably be to remove the borders, because they are quite obtrusive.  Just add the following CSS to your page header.</p>
<pre>.YUI 3-carousel {
  border: none !important;
}
.YUI 3-carousel-nav {
  background: none !important;
}
.carousel ol li {
  border: none !important;
}</pre>
<p>Now, that looks better.  I&#8217;ve also used a negative margin to reduce the gap between my Carousel and the heading.  However, we are still not completely there.  I assume that you also want to use your own custom buttons, which integrate nicely into your page layout.  For this example we will use the same buttons that are also used on Yahoo&#8217;s search result pages.  This requires a bit more, but still simple, CSS.</p>
<pre>.YUI 3-carousel-button {
  background: url("sprite_button.png") no-repeat scroll 0 0 transparent !important;
  height: 20px !important; width: 28px !important;
}
.YUI 3-carousel-nav-item {
  background: url("sprite_button.png") no-repeat scroll 0 0 transparent !important;
  background-position: -133px 0 !important;
}
.YUI 3-carousel-first-button {
  background-position: -90px 0 !important;
  margin-right: 35px !important;
}
.YUI 3-carousel-first-button-disabled {
  background-position: -60px 0 !important;
  margin-right: 35px !important;
}
.YUI 3-carousel-next-button {
  background-position: -30px 0 !important;
}
.YUI 3-carousel-button-disabled {
  background-position: 0 0 !important;
}
.YUI 3-carousel-nav-item-selected {
  background-position: -121px 0 !important;
}</pre>
<p>We will leave it to that for today and hope you feel ready to get started.  At least that was all that we needed.  However, depending on how big your site is and how interested you are in its performance, there are general thoughts about loading something from a third party content delivery network that also apply here.  For example, Sidnei da Silva laid out some interesting thoughts in a blog post earlier this month.  We would be happy to provide a How To that explains how a YUI widget and its dependencies can be moved to your own website, or even content delivery network, so you are able to keep the number of HTTP requests as low as possible.  Let us know if you are interested, we are looking forward to your feedback!</p>
<h3>More to Explore in the Gallery</h3>
<p>The <a href="http://developer.yahoo.com/yui/theater/video.php?v=yuiconf2010-alloy" title="Video: Nate Cavanaugh and Eduardo Lundgren &mdash; A Whirlwind Tour of AlloyUI Components in the YUI 3 Gallery (YUI Theater)">excellent team of Eduardo Lundgren and Nate Cavanaugh of Liferay</a> have <a href="http://yuilibrary.com/gallery/show/aui-carousel" title="YUI Library :: Gallery :: AlloyUI Carousel">a Carousel component in the Gallery as well</a> — certainly worth checking out if you&#8217;re in the market for this kind of control.</p>
						</div>

						<div class="meta">
    <img src="http://www.gravatar.com/avatar/d4113c8d86e050d2221e76685b918695?s=32"> <div class="cont"><span class="name">By Gopal Venkatesan and Fabian Frank</span><span class="date">December 13th, 2010<span></div></div>
				</div>
										
								<div class="post-2950 post type-post status-publish format-standard hentry category-yui-3-gallery category-yui-theater tag-alloyui tag-eduardo-lundgren tag-liferay tag-nate-cavanaugh tag-yahoo tag-yui-theater">
				
						<h2 id="post-2950"><a href="/yuiblog/blog/2010/11/30/video-yuiconf2010-alloy/">YUI Theater &mdash;  Nate Cavanaugh and Eduardo Lundgren: &#8220;A Whirlwind Tour of AlloyUI Components in the YUI 3 Gallery&#8221; (67 min.)</a></h2>
					

						<div class="entry">
							<p><a href="http://developer.yahoo.com/yui/theater/video.php?v=yuiconf2010-alloy"><img src="/blog-archive/assets/yuiconf2010-alloy-20101126-224724.jpg" alt="Liferay engineers Nate Cavanaugh and Eduardo Lundgren speak about AlloyUI at YUIConf 2010 at Yahoo! HQ in Sunnyvale, CA." width="510"></a></p>
<p>In this session from YUIConf 2010, <a href="http://www.liferay.com/" title="Enterprise open source portal and collaboration software - Liferay.com">Liferay</a> engineers Nate Cavanaugh and Eduardo Lundgren talk about the dozens of high-quality, YUI 3-based components contributed by their <a href="http://alloy.liferay.com/" title="Alloy UI - A project of Liferay">AlloyUI</a> project to the <a href="http://yuilibrary.com/gallery/" title="YUI Library :: Gallery">YUI 3 Gallery</a>.  You can&#8217;t appreciate the full spectrum of what YUI 3 offers without seeing what Nate and Eduardo have made available for your use.</p>
<p>If the video embed below doesn&#8217;t show up correctly in your RSS reader of choice, be sure to <a href="http://developer.yahoo.com/yui/theater/video.php?v=yuiconf2010-alloy">click through to watch the high-resolution version of the video on YUI Theater</a>.</p>
<p>
<div><object width="510" height="287"><param name="movie" value="http://d.yimg.com/m/up/ypp/default/player.swf"></param><param name="flashVars" value="vid=23267904&#038;"></param><param name="allowfullscreen" value="true"></param><param name="wmode" value="transparent"></param><embed width="510" height="287" allowFullScreen="true" src="http://d.yimg.com/m/up/ypp/default/player.swf" type="application/x-shockwave-flash" flashvars="vid=23267904&#038;"></embed></object></div>
</p>
<ul>
<li><a href='http://yui.zenfs.com/theater/yuiconf2010-alloy-hd.mov'>Download HD video (480p ~474MB)</a></li>
<li><a href="http://yui.zenfs.com/theater/yuiconf2010-alloy.m4v">Download video (m4v)</a></li>
</ul>
<h3>Other Recent YUI Theater Videos:</h3>
<ul>
<li><a href='http://developer.yahoo.com/yui/theater/video.php?v=yuiconf2010-dahl'><strong>Ryan Dahl:</strong> Node.js Roadmap</a> &mdash; Node.js creator Ryan Dahl delivers one of the most technical (and amusing) talks at YUIConf 2010, diving into the details of Node.js&#8217;s present state and future roadmap.</li>
<li><a href='http://developer.yahoo.com/yui/theater/video.php?v=yuiconf2010-susarla'><strong>Nagesh Susarla:</strong> Building YQL Open Data Tables with YQL Execute</a> &mdash; YQL engineer Nagesh Susarla explores the power of YQL execute in the creation of powerful YQL open data tables.</li>
<li><a href='http://developer.yahoo.com/yui/theater/video.php?v=yuiconf2010-introtoyql'><strong>Mirek Grymuza and Josh Gordineer:</strong> YQL: An Introduction</a> &mdash; Mirek Grymuza and Josh Gordineer are members of the team that brings you YQL, the remarkable Yahoo data service that turns the internet into a database accessible via familiar SQL-style syntax.  In this talk from YUIConf 2010, they provide a baseline introduction to YQL&#8217;s history, features, and core uses.</li>
<li><a href='http://developer.yahoo.com/yui/theater/video.php?v=yuiconf2010-koechley'><strong>Nate Koechley:</strong> A Taxonomy of Touch</a> &mdash; YUI contributor Nate Koechley breaks down the elements of touch primitives, gestures and semantics, laying a foundation for the broader language of touch interactions that drive the emerging class of portable devices.</li>
<li><a href='http://developer.yahoo.com/yui/theater/video.php?v=yuiconf2010-yuitest'><strong>Nicholas C. Zakas:</strong> YUI Test</a> &mdash; Yahoo! Front Page engineer, author and YUI contributor Nicholas C. Zakas talks about the new standalone YUI Test project which has been broken out from its YUI 2 and YUI 3 roots.</li>
</ul>
<h3>CC Content/Used by Kind Permission:</h3>
<ul>
<li><a href='http://www.flickr.com/photos/uberlife/5161516499/'>http://www.flickr.com/photos/uberlife/5161516499/</a></li>
<li><a href='http://www.flickr.com/photos/uberlife/5165069249/'>http://www.flickr.com/photos/uberlife/5165069249/</a></li>
</ul>
<h3>Subscribing to YUI Theater:</h3>
<ul>
<li><a href="http://feeds.feedburner.com/yuiblog/yui-theater">YUI Theater RSS feed</a></li>
<li><a href="http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewPodcast?id=263846173&amp;s=143441">YUI Theater on iTunes</a></li>
</ul>
						</div>

						<div class="meta">
    <img src="http://www.gravatar.com/avatar/d011327f5a3d4f1dc4215968e2bfd524?s=32"> <div class="cont"><a href="http://ericmiraglia.com" class="name">By Eric Miraglia</a><span class="date">November 30th, 2010<span></div></div>
				</div>
										
								<div class="post-2887 post type-post status-publish format-standard hentry category-development category-yui-3-gallery">
				
						<h2 id="post-2887"><a href="/yuiblog/blog/2010/11/29/in-the-yui-3-gallery-server-sent-events/">In the YUI 3 Gallery: Server-Sent Events</a></h2>
					

						<div class="entry">
							<p>Push notifications on the web are increasing in popularity, as evidenced by the excitement over <a href="http://www.w3.org/TR/websockets/">Web Sockets</a>, and with good reason. The web is moving towards more accurate and up-to-date information as audiences turn to the Internet for real-time updates of stocks, news, sports, and more. While Web Sockets represents a giant leap forward in the realm of push notifications, there is a lesser-known spec that can be considered a small jump forward: <a href="http://dev.w3.org/html5/eventsource/">Server-Sent Events</a>.</p>
<p>Server-Sent Events (SSE) are also targeted at making push notifications easier by building on top of the techniques that developers are already using.  As opposed to Web Sockets, SSE uses regular HTTP to communicate with the server and allows you to decide whether to use <a href="http://en.wikipedia.org/wiki/Comet_%28programming%29#Streaming">HTTP streaming</a>, <a href="http://en.wikipedia.org/wiki/Comet_%28programming%29#Ajax_with_long_polling">long polling</a>, or even regular polling to retrieve new data (though this isn&#8217;t recommended).</p>
<p>At the heart of SSE is the <code>EventSource</code> object. The <a href="http://yuilibrary.com/gallery/show/eventsource">YUI 3 Gallery EventSource</a> module creates a cross-browser implementation of <code>EventSource</code>, bringing support for Server-Sent Events to all browsers that support the <code>XMLHttpRequest</code>, including Internet Explorer 6, while falling back to the native implementation in browsers that have it (currently Safari 5, Chrome 7, and Opera 10.7).</p>
<p>The <code>EventSource</code> interprets a response as an event stream (signified by a content type of &#8220;text/event-stream&#8221;) and fires appropriate events. There are three predefined events:</p>
<ul>
<li><code>open</code> &#8211; fires when the connection with the server has been established.</li>
<li><code>message</code> &#8211; fires when a new message is received from the server. The <code>event.data</code> property contains the new data.
<li><code>error</code> &#8211; fires when an error occurs in processing the event stream. Once this event fires, no further events will be processed and the server connection is permanently closed.</li>
</ul>
<p>The event stream itself is plain text data made up of the keyword &#8220;data:&#8221; followed by some data on a single line. If you wish to have multiple lines, you must include more rows with &#8220;data:&#8221; prefixes. A empty line is considered the boundary between events. Here&#8217;s a simple example:</p>
<pre><code>data: hello

data: hello
data: world
</code></pre>
<p>Two <code>message</code> events are fired with this event stream. The first has <code>event.data</code> set to &#8220;hello&#8221; while the second has <code>event.data</code> set to &#8220;hello\nworld&#8221; (note the new line).</p>
<p>Here&#8217;s an example of creating a new <code>EventSource</code> instance:</p>
<pre><code>YUI({
    gallery: 'gallery-2010.11.17-21-32'
}).use('gallery-eventsource', function(Y) {
 
    var src = new Y.EventSource("stream.php");
 
    src.on("open", function(event){
        console.log("Connection opened!");
    });
 
    src.on("message", function(event){
        console.log("Data received: " + event.data);
    });
 
    src.on("error", function(event){
        console.log("Error!");
    });
 
});
</code></pre>
<p>The constructor accepts a single argument, which is the URL of the event stream. The interesting and useful part of <code>EventSource</code> is that it will automatically reconnect to the server if the connection is lost for any reason. Doing so frees developers from needing to worry about disconnecting and reconnecting, a frequent complaint when using <code>XMLHttpRequest</code> for push notifications.</p>
<p>Even though the YUI 3 Gallery EventSource module matches the specification with support for HTTP streaming, long polling, and regular polling, not all browsers support all three. Internet Explorer (up to and including version 9) does not support HTTP streaming, while it can easily handle long or regular polling. The recommended usage of this module is to build your experience with a long polling implementation for best performance and compatibility. </p>
<p>If you&#8217;d like to optimize for browsers that support HTTP streaming, the module sets a special <code>X-YUIEventSource-PollOnly</code> header when it detects a browser that can&#8217;t use HTTP streaming. You can check for this header on the server to determine the correct way to serve data. Here&#8217;s an example implementation using JSP:</p>
<pre><code>&lt;%@page contentType="text/event-stream" buffer="none"%&gt;
&lt;%

    //check for poll-only header
    String header = request.getHeader("X-YUIEventSource-PollOnly");

    //check every so often to see if there's new data
    while(true) {        

        //sleep for a second - simulate waiting for data
        Thread.sleep(1000);        

        //output the current time, ensure there are two trailing newlines
        out.print("data: " + (new java.util.Date()).toString() + "x\n\n");
        out.flush();

        //if it's a poll-only request, break the loop, 
        //which ends the request - the client will reconnect
        if (header != null){
            break;
        }
    }
%&gt;</code></pre>
<p>It&#8217;s fairly easy to migrate existing long polling solutions to use SSE, provided the data format is simple. Since the format of event streams is line-based, that could mean reformatting some data to sit on a single line instead of multiple lines.</p>
<p>While SSE will never have the same performance characteristics as Web Sockets due to using HTTP, it does represent a logical evolution of push notifications in browsers. SSE can replace older <code>XMLHttpRequest</code>-based solutions with less code and better error handling, all while keeping the same authentication paradigm.</p>
<p>The YUI 3 Gallery EventSource module implements almost all of the SSE spec (you can see in the source code which parts are not yet implemented by searching for &#8220;TODO&#8221; comments). This is because some of the features are vaguely described. The module supports the following features:</p>
<ul>
<li>Simple events (fire <code>message</code> event).</li>
<li>Custom events (fire an event matching the name specified in &#8220;event:&#8221;)</li>
<li>Event IDs (captured in <code>event.lastEventId</code> and sent to the server)</li>
</ul>
<p>The parts that have yet to be implemented are support for reconnection times and the <code>event.origin</code> property. Otherwise, everything else should behave the same as the native implementation.</p>
<h3>Further Reading</h3>
<ul>
<li><a href="http://www.nczonline.net/blog/2010/10/19/introduction-to-server-sent-events/">Introduction to Server-Sent Events</a></li>
<li><a href="http://my.opera.com/core/blog/eventsource">The Long Journey of Server-Sent Events</a></li>
</ul>
						</div>

						<div class="meta">
    <img src="http://www.gravatar.com/avatar/f071cb9c72c08020c83a0838b192145a?s=32"> <div class="cont"><a href="http://nczonline.net" class="name">By Nicholas C. Zakas</a><span class="date">November 29th, 2010<span></div></div>
				</div>
							
							<div class="bottom-nav">
					<div class="navigation yui3-g">
	<div class="next-posts yui3-u"><a href="/yuiblog/blog/category/yui-3-gallery/page/3/" >&laquo; Older Entries</a></div>
            <span class="greyed nav-separator">|</span> 
    	<div class="prev-posts yui3-u-1-2">
        <a href="/yuiblog/blog/category/yui-3-gallery/" >Newer Entries &raquo;</a>    </div>
</div>				</div>
						
	
</div>
</div>

<div id="sidebar" class="yui3-u-1-4"><div class="liner">

    <div id="pages-3" class="sidebox widget widget_pages"><div class="hd"><h2>Pages</h2></div><div class="bd">		<ul>
			<li class="page_item page-item-2"><a href="/yuiblog/blog/about/">About</a></li>
<li class="page_item page-item-989"><a href="/yuiblog/blog/contribute/">Contribute</a></li>
<li class="page_item page-item-1284"><a href="/yuiblog/blog/yui-team-positions/">YUI Jobs</a></li>
		</ul>
		</div></div>		<div id="archives-3" class="sidebox widget widget_archive"><div class="hd"><h2>Archives</h2></div><div class="bd">		<select name="archive-dropdown" onchange='document.location.href=this.options[this.selectedIndex].value;'> <option value="">Select Month</option> 	<option value='/yuiblog/blog/2014/06/'> June 2014 </option>
	<option value='/yuiblog/blog/2014/05/'> May 2014 </option>
	<option value='/yuiblog/blog/2014/04/'> April 2014 </option>
	<option value='/yuiblog/blog/2014/03/'> March 2014 </option>
	<option value='/yuiblog/blog/2014/02/'> February 2014 </option>
	<option value='/yuiblog/blog/2014/01/'> January 2014 </option>
	<option value='/yuiblog/blog/2013/12/'> December 2013 </option>
	<option value='/yuiblog/blog/2013/11/'> November 2013 </option>
	<option value='/yuiblog/blog/2013/10/'> October 2013 </option>
	<option value='/yuiblog/blog/2013/09/'> September 2013 </option>
	<option value='/yuiblog/blog/2013/08/'> August 2013 </option>
	<option value='/yuiblog/blog/2013/07/'> July 2013 </option>
	<option value='/yuiblog/blog/2013/06/'> June 2013 </option>
	<option value='/yuiblog/blog/2013/05/'> May 2013 </option>
	<option value='/yuiblog/blog/2013/04/'> April 2013 </option>
	<option value='/yuiblog/blog/2013/03/'> March 2013 </option>
	<option value='/yuiblog/blog/2013/02/'> February 2013 </option>
	<option value='/yuiblog/blog/2013/01/'> January 2013 </option>
	<option value='/yuiblog/blog/2012/12/'> December 2012 </option>
	<option value='/yuiblog/blog/2012/11/'> November 2012 </option>
	<option value='/yuiblog/blog/2012/10/'> October 2012 </option>
	<option value='/yuiblog/blog/2012/09/'> September 2012 </option>
	<option value='/yuiblog/blog/2012/08/'> August 2012 </option>
	<option value='/yuiblog/blog/2012/07/'> July 2012 </option>
	<option value='/yuiblog/blog/2012/06/'> June 2012 </option>
	<option value='/yuiblog/blog/2012/05/'> May 2012 </option>
	<option value='/yuiblog/blog/2012/04/'> April 2012 </option>
	<option value='/yuiblog/blog/2012/03/'> March 2012 </option>
	<option value='/yuiblog/blog/2012/02/'> February 2012 </option>
	<option value='/yuiblog/blog/2012/01/'> January 2012 </option>
	<option value='/yuiblog/blog/2011/12/'> December 2011 </option>
	<option value='/yuiblog/blog/2011/11/'> November 2011 </option>
	<option value='/yuiblog/blog/2011/10/'> October 2011 </option>
	<option value='/yuiblog/blog/2011/09/'> September 2011 </option>
	<option value='/yuiblog/blog/2011/08/'> August 2011 </option>
	<option value='/yuiblog/blog/2011/07/'> July 2011 </option>
	<option value='/yuiblog/blog/2011/06/'> June 2011 </option>
	<option value='/yuiblog/blog/2011/05/'> May 2011 </option>
	<option value='/yuiblog/blog/2011/04/'> April 2011 </option>
	<option value='/yuiblog/blog/2011/03/'> March 2011 </option>
	<option value='/yuiblog/blog/2011/02/'> February 2011 </option>
	<option value='/yuiblog/blog/2011/01/'> January 2011 </option>
	<option value='/yuiblog/blog/2010/12/'> December 2010 </option>
	<option value='/yuiblog/blog/2010/11/'> November 2010 </option>
	<option value='/yuiblog/blog/2010/10/'> October 2010 </option>
	<option value='/yuiblog/blog/2010/09/'> September 2010 </option>
	<option value='/yuiblog/blog/2010/08/'> August 2010 </option>
	<option value='/yuiblog/blog/2010/07/'> July 2010 </option>
	<option value='/yuiblog/blog/2010/06/'> June 2010 </option>
	<option value='/yuiblog/blog/2010/05/'> May 2010 </option>
	<option value='/yuiblog/blog/2010/04/'> April 2010 </option>
	<option value='/yuiblog/blog/2010/03/'> March 2010 </option>
	<option value='/yuiblog/blog/2010/02/'> February 2010 </option>
	<option value='/yuiblog/blog/2010/01/'> January 2010 </option>
	<option value='/yuiblog/blog/2009/12/'> December 2009 </option>
	<option value='/yuiblog/blog/2009/11/'> November 2009 </option>
	<option value='/yuiblog/blog/2009/10/'> October 2009 </option>
	<option value='/yuiblog/blog/2009/09/'> September 2009 </option>
	<option value='/yuiblog/blog/2009/08/'> August 2009 </option>
	<option value='/yuiblog/blog/2009/07/'> July 2009 </option>
	<option value='/yuiblog/blog/2009/06/'> June 2009 </option>
	<option value='/yuiblog/blog/2009/05/'> May 2009 </option>
	<option value='/yuiblog/blog/2009/04/'> April 2009 </option>
	<option value='/yuiblog/blog/2009/03/'> March 2009 </option>
	<option value='/yuiblog/blog/2009/02/'> February 2009 </option>
	<option value='/yuiblog/blog/2009/01/'> January 2009 </option>
	<option value='/yuiblog/blog/2008/12/'> December 2008 </option>
	<option value='/yuiblog/blog/2008/11/'> November 2008 </option>
	<option value='/yuiblog/blog/2008/10/'> October 2008 </option>
	<option value='/yuiblog/blog/2008/09/'> September 2008 </option>
	<option value='/yuiblog/blog/2008/08/'> August 2008 </option>
	<option value='/yuiblog/blog/2008/07/'> July 2008 </option>
	<option value='/yuiblog/blog/2008/06/'> June 2008 </option>
	<option value='/yuiblog/blog/2008/05/'> May 2008 </option>
	<option value='/yuiblog/blog/2008/04/'> April 2008 </option>
	<option value='/yuiblog/blog/2008/03/'> March 2008 </option>
	<option value='/yuiblog/blog/2008/02/'> February 2008 </option>
	<option value='/yuiblog/blog/2008/01/'> January 2008 </option>
	<option value='/yuiblog/blog/2007/12/'> December 2007 </option>
	<option value='/yuiblog/blog/2007/11/'> November 2007 </option>
	<option value='/yuiblog/blog/2007/10/'> October 2007 </option>
	<option value='/yuiblog/blog/2007/09/'> September 2007 </option>
	<option value='/yuiblog/blog/2007/08/'> August 2007 </option>
	<option value='/yuiblog/blog/2007/07/'> July 2007 </option>
	<option value='/yuiblog/blog/2007/06/'> June 2007 </option>
	<option value='/yuiblog/blog/2007/05/'> May 2007 </option>
	<option value='/yuiblog/blog/2007/04/'> April 2007 </option>
	<option value='/yuiblog/blog/2007/03/'> March 2007 </option>
	<option value='/yuiblog/blog/2007/02/'> February 2007 </option>
	<option value='/yuiblog/blog/2007/01/'> January 2007 </option>
	<option value='/yuiblog/blog/2006/12/'> December 2006 </option>
	<option value='/yuiblog/blog/2006/11/'> November 2006 </option>
	<option value='/yuiblog/blog/2006/10/'> October 2006 </option>
	<option value='/yuiblog/blog/2006/09/'> September 2006 </option>
	<option value='/yuiblog/blog/2006/08/'> August 2006 </option>
	<option value='/yuiblog/blog/2006/07/'> July 2006 </option>
	<option value='/yuiblog/blog/2006/06/'> June 2006 </option>
	<option value='/yuiblog/blog/2006/05/'> May 2006 </option>
	<option value='/yuiblog/blog/2006/04/'> April 2006 </option>
	<option value='/yuiblog/blog/2006/03/'> March 2006 </option>
	<option value='/yuiblog/blog/2006/02/'> February 2006 </option>
 </select>
</div></div><div id="categories-2" class="sidebox widget widget_categories"><div class="hd"><h2>Categories</h2></div><div class="bd">		<ul>
	<li class="cat-item cat-item-69"><a href="/yuiblog/blog/category/accessibility/" title="View all posts filed under Accessibility">Accessibility</a> (25)
</li>
	<li class="cat-item cat-item-524"><a href="/yuiblog/blog/category/css-101/" title="View all posts filed under CSS 101">CSS 101</a> (8)
</li>
	<li class="cat-item cat-item-1"><a href="/yuiblog/blog/category/design/" title="This category is for design related posts. For example, all posts about the design pattern library belong here.">Design</a> (51)
</li>
	<li class="cat-item cat-item-2"><a href="/yuiblog/blog/category/development/" title="For development related posts, including all posts about the Yahoo! User Interface Library.">Development</a> (652)
</li>
	<li class="cat-item cat-item-219"><a href="/yuiblog/blog/category/frontend-engineering-jobs-at-yahoo/" title="View all posts filed under Frontend Jobs at Yahoo">Frontend Jobs at Yahoo</a> (13)
</li>
	<li class="cat-item cat-item-96"><a href="/yuiblog/blog/category/graded-browser-support/" title="View all posts filed under Graded Browser Support">Graded Browser Support</a> (8)
</li>
	<li class="cat-item cat-item-11"><a href="/yuiblog/blog/category/in-the-wild/" title="In which we mention and link to third-party tutorials, discussions, comments, feedback, and implementations.">In the Wild</a> (63)
</li>
	<li class="cat-item cat-item-403"><a href="/yuiblog/blog/category/miscellany/" title="View all posts filed under Miscellany">Miscellany</a> (13)
</li>
	<li class="cat-item cat-item-483"><a href="/yuiblog/blog/category/open-hours/" title="View all posts filed under Open Hours">Open Hours</a> (44)
</li>
	<li class="cat-item cat-item-13"><a href="/yuiblog/blog/category/performance/" title="View all posts filed under Performance">Performance</a> (23)
</li>
	<li class="cat-item cat-item-598"><a href="/yuiblog/blog/category/releases/" title="View all posts filed under Releases">Releases</a> (50)
</li>
	<li class="cat-item cat-item-592"><a href="/yuiblog/blog/category/target-environments/" title="View all posts filed under Target Environments">Target Environments</a> (11)
</li>
	<li class="cat-item cat-item-599"><a href="/yuiblog/blog/category/development/yeti-development/" title="View all posts filed under Yeti">Yeti</a> (5)
</li>
	<li class="cat-item cat-item-292 current-cat"><a href="/yuiblog/blog/category/yui-3-gallery/" title="View all posts filed under YUI 3 Gallery">YUI 3 Gallery</a> (34)
</li>
	<li class="cat-item cat-item-286"><a href="/yuiblog/blog/category/yui-events/" title="View all posts filed under YUI Events">YUI Events</a> (48)
</li>
	<li class="cat-item cat-item-8"><a href="/yuiblog/blog/category/yui-implementations/" title="View all posts filed under YUI Implementations">YUI Implementations</a> (55)
</li>
	<li class="cat-item cat-item-9"><a href="/yuiblog/blog/category/yui-theater/" title="View all posts filed under YUI Theater">YUI Theater</a> (164)
</li>
	<li class="cat-item cat-item-595"><a href="/yuiblog/blog/category/yui-weekly/" title="View all posts filed under YUI Weekly">YUI Weekly</a> (76)
</li>
	<li class="cat-item cat-item-602"><a href="/yuiblog/blog/category/yui-conf/" title="Posts pertaining to YUIConf - videos, notices, updates.">YUIConf</a> (27)
</li>
		</ul>
</div></div><div id="meta-2" class="sidebox widget widget_meta"><div class="hd"><h2>Meta</h2></div><div class="bd">			<ul>
						<li><a href="/yuiblog/blog/wp-login.php">Log in</a></li>
			<li><a href="/yuiblog/blog/feed/" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="/yuiblog/blog/comments/feed/" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>						</ul>
</div></div>
</div></div>
		</div><!-- /#bd -->
		<div id="ft">
			<footer>
				<div class="copyright">
			&copy; 2014 YUI Blog				</div>
			</footer></div></div><!-- /#doc -->

	<script type="text/javascript" language="JavaScript">
//<![CDATA[
var wpdone;
function wpvisit()
{
  var z;
  z="&r="+escape(document.referrer);
  z=z+"&b="+escape(navigator.appName+" "+navigator.appVersion);
  w=parseFloat(navigator.appVersion);
  if (w > 2.0) {
    z=z+"&s="+screen.width+"x"+screen.height;
    z=z+"&o="+navigator.platform;
    v="1.2";
    if (navigator.appName != "Netscape") {
      z=z+"&c="+screen.colorDepth;
    } else {
      z=z+"&c="+screen.pixelDepth
    }
    z=z+"&j="+navigator.javaEnabled();
  } else {
    v=1.0;
  }
  z=z+"&v="+v;

  document.writeln("<img border=\"0\" src=\"http://visit.webhosting.yahoo.com/wisit.gif"+"/blog/"+"?"+z+"\" />");
}
  wpvisit();
//]]>
</script>

<noscript><img src="http://visit.webhosting.yahoo.com/wisit.gif?1404290653" border="0" width="1" height="1" alt="visit" /></noscript>	
	<!-- Don't forget analytics -->

	<script src="http://yuilibrary.com/combo/hoverable-min.js"></script>

        <!-- Minified main.js from yuilibrary.com, with 'search' module requirement removed. -->
        <script>(function(){var b=navigator.userAgent,c="",a="";if(/windows/i.test(b)){a="pc";c="win"}else{if(/macintosh/i.test(b)){a="mac";c="osx"}else{if(/ios/i.test(b)){c="ios";if(/(?:iphone|ipod)/i.test(b)){a="iphone mac"}else{if(/ipad/i.test(b)){a="ipad mac"}}}else{if(/linux/i.test(b)){if(/android/i.test(b)){a="android pc"}else{a="pc"}c="linux"}}}}document.documentElement.className+=" "+a+" "+c}());YUI().use("hoverable",function(b){var a=new b.Hoverable({hoverClass:"nav-tab-hover",srcNode:"#main-nav"})});
        </script>
	<script src="http://yuilibrary.com/vendor/prettify/prettify-min.js"></script>
	<script>prettyPrint();</script>

	<script>
	(function() { /***
		var ga = document.createElement('script'); ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		***/
	}());
	</script>
	
</body></html><script type="text/javascript">(function (d, w) {var x = d.getElementsByTagName('SCRIPT')[0];var f = function () {var s = d.createElement('SCRIPT');s.type = 'text/javascript';s.async = true;s.src = "//np.lexity.com/embed/YW/50f0aba8ce9ea20d2fd1df9287951fe1?id=4bff116c1ea8";x.parentNode.insertBefore(s, x);};w.attachEvent ? w.attachEvent('onload',f) :w.addEventListener('load',f,false);}(document, window));</script>